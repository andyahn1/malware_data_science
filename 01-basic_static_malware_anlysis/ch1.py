# import pefile, a Portable Executable reader module.
import pefile
# open and parse the PE file, ircbot.exe, using pefile
pe = pefile.PE("/replace_this_with_the_absolute_path_of/ircbot.exe")

# Tell us about the PE sections of this file, ircbot.exe!
for section in pe.sections:
    print(
        # "section name" of the PE file
        section.Name,
        # "base virtual memory address" where these sections will be loaded
        hex(section.VirtualAddress),
        # "virual size" field specifies the amount of memory required by the section once loaded
        hex(section.Misc_VirtualSize),
        # amount of data the section will take up within that chunk of memory
        section.SizeOfRawData
    )

# list the DLLs and the functions it will request within those DLLs
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print(entry.dll)
    for function in entry.imports:
        # somehow print('\t',function.name) prints like this: ('\t', 'GetStringTypeA')
        print '\t',function.name

# output will look like this
'''
KERNEL32.DLL
	GetLocalTime
	ExitThread
	CloseHandle
	WriteFile # this function tells us this malware will write to files
	CreateFileA # open files
	ExitProcess
	CreateProcessA # create new processes
	GetTickCount
	GetModuleFileNameA
	GetSystemDirectoryA
    ...
'''
